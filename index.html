<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Green Earth | Plant Shop</title>

    <!-- Custom Css -->
    <link rel="stylesheet" href="./styles/styles.css">

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

</head>


<body class="bg-green-50 overflow-x-hidden">


    <header class="mb-20">

        <!-- Nav starts -->

        <nav class="nav-bar bg-[#15803D] p-5">
            <div class="flex flex-col lg:flex-row justify-between place-items-center px-5">
                <h1 class="text-white font-bold text-2xl">Green Earth</h1>
                <div class="text-white cursor-pointer py-4">
                    <span>About</span>
                    <span class="px-3">Gallery</span>
                    <span>Plant a Tree</span>
                </div>
                <button
                    class="bg-[#FACC15] py-3 px-5 rounded-xl text-[#15803D] font-semibold cursor-pointer hover:scale-125 transition-transform block">Plant
                    a Tree</button>
            </div>
        </nav>

        <!-- Banner starts -->

        <div class="banner bg-[#CFF0DC] flex flex-col lg:flex-row  place-items-center justify-between">
            <img class="" src="./assets/hero-leaf1.png" alt="">
            <div class="text-center my-5">
                <h1 class="font-bold text-5xl mt-5">Plant a Tree, Grow a Future</h1>
                <p class="my-5">Join our mission to plant 1 million trees and make the Earth greener for future
                    generations.</p>
                <button
                    class="bg-[#FACC15] py-3 px-5 rounded-xl text-[#15803D] font-semibold cursor-pointer hover:scale-125 transition-transform">Get
                    Involved</button>
            </div>
            <img src="./assets/hero-leaf2.png" alt="">

        </div>
    </header>

    <div class="max-w-[1440px] mx-auto px-4 md:px-6 lg:px-8 mt-10 text-center">
        <h2 class="text-2xl md:text-3xl font-bold text-green-800">Plants to Choose</h2>
    </div>

    <!-- Main Shop Section -->

    <main class="max-w-[1440px] mx-auto p-4 md:p-6 lg:p-8 grid grid-cols-1 lg:grid-cols-5 gap-6 lg:gap-8">

        <!-- Categories Panel -->
        <aside class="col-span-1 bg-white p-6 rounded shadow-md h-fit">
            <h2 class="text-xl md:text-2xl font-bold text-green-800 mb-4 text-center lg:text-left">Categories</h2>

            <div id="category-list" class="flex flex-col gap-3">
                <div class="bg-green-300 font-medium px-4 py-2 rounded-lg cursor-pointer hover:bg-green-500 transition-colors active-category"
                    data-category-id="all">All Plants</div>
            </div>
        </aside>

        <!-- Products Section -->


        <section class="col-span-1 lg:col-span-3">

            <div id="plants-loader-spinner" class="w-10 h-10 flex justify-center items-center">

                <div class="loading-spinner w-10 h-10">
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                </div>
            </div>


            <div id="products-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">

            </div>

            <div id="category-loader-spinner" class="w-10 h-10 flex justify-center items-center">
                <div class="loading-spinner w-10 h-10 ">
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                    <div class="spinner-bar"></div>
                </div>
            </div>
        </section>

           <!-- Shopping Cart Summary -->
        <aside class="col-span-1 bg-white p-6 rounded-2xl shadow-md h-fit">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl md:text-2xl font-bold text-green-800">Your Cart</h2>
                <span id="cart-item-count"
                    class="bg-green-100 text-green-700 font-medium px-3 py-1 rounded-full">0</span>
            </div>
            <div id="cart-items-container" class="space-y-4 min-h-[50px]">

            </div>
            <div
                class="border-t-2 border-green-200 mt-6 pt-4 flex justify-between items-center font-bold text-lg text-green-800">
                <span>Total:</span>
                <span id="cart-total-display">৳0</span>
            </div>
        </aside>
    </main>

    <div class="text-center mt-14 mb-5 font-bold text-4xl"> About the campaign</div>
    <section class="max-w-[1100px] mx-auto flex flex-col lg:flex-row gap-8 place-items-center mb-14 ">
        <div class="lg:w-1/2 p-5">
            <img src="./assets/about.png" alt="">
        </div>
        <div class="lg:w-1/2 p-5">
            <p>
                Green Earth is a global tree plantation initiative dedicated to fighting climate change. Since our
                start, we’ve planted over 500,000 trees worldwide. By joining our campaign, you help restore forests,
                create habitats for wildlife, and combat global warming.
            </p>
            <ul class="list-disc ml-8">
                <li>Restoration of natural habitats</li>
                <li>Improvement of air quality</li>
                <li>Improvement of air quality</li>
            </ul>
        </div>
    </section>

    <section class="impact bg-[#CFF0DC] pb-10">
        <h1 class="text-center mb-8 pt-10 font-bold text-3xl ">Our impact</h1>
        <div class="container mx-auto flex flex-col p-5 lg:flex-row gap-10 justify-between pb-10">
            <div class="w-full h-40 bg-white place-items-center content-center rounded-3xl text-green-700  hover:scale-110 transition hover:bg-cyan-300 hover:text-white hover:font-bold">
                <h1 class="text-4xl font-bold">500k+</h1>
                <p>Trees Planted</p>

            </div>
            <div class="w-full h-40  bg-white place-items-center content-center rounded-3xl text-green-700  hover:scale-110 transition hover:bg-cyan-300 hover:text-white hover:font-bold">
                <h1 class="text-4xl font-bold">120+</h1>
                <p>Communities involved </p>

            </div>
            <div class="w-full h-40 text-green-700 bg-white place-items-center content-center rounded-3xl hover:scale-110 transition hover:bg-cyan-300 hover:text-white hover:font-bold">
                <h1 class="text-4xl font-bold">30+</h1>
                <p>Countries Reached</p>

            </div>

        </div>
    </section>

    <section class="form bg-[#166534]">
        <div>
            <h1 class="text-center py-10 font-bold text-3xl text-white">Plant a Tree Today</h1>
            <div class="flex  justify-center items-center pb-10">
                <form
                    class="flex flex-col items-center md:items-start space-y-4 p-8 rounded-lg w-1/2 lg:w-1/3 bg-[#15803D]">
                    <input type="text" placeholder="Your Name"
                        class="w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-green-500">
                    <input type="email" placeholder="Your Email"
                        class="w-full  p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-green-500">
                    <select class="w-full  p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-green-500">
                        <option value="">Number of Trees</option>
                        <option value="1">1 Tree</option>
                        <option value="5">5 Trees</option>
                        <option value="10">10 Trees</option>
                        <option value="50">50 Trees</option>
                    </select>
                    <button type="submit"
                        class="bg-[#FACC15] text-green-800 px-6 py-3 rounded-xl w-full font-semibold hover:scale-110 transition-transform">
                        Donate Now
                    </button>
            </div>



        </div>

    </section>

    <!-- Footer -->
    <footer class="bg-[#14532D] text-white text-center p-4">
        <p>© 2025 Green Earth. All Rights Reserved.</p>
    </footer>




    <!-- Plant Details Modal -->
    <div id="product-details-modal"
        class="fixed inset-0 bg-black bg-opacity-50 place-items-center content-center p-4 z-[100] hidden">
        <div class="bg-white rounded-2xl p-6 shadow-2xl max-w-lg w-full relative">
            <button id="modal-close-button"
                class="absolute top-4 right-4 text-gray-500 text-3xl hover:text-gray-800">&times;</button>
            <div id="modal-content-container">
            </div>
        </div>
    </div>

    <!-- Alert Message -->

    <div id="alert-message"
        class="fixed bottom-6 left-1/2 -translate-x-1/2 bg-green-700 text-white px-6 py-3 rounded-xl shadow-lg transition-all duration-300 opacity-0 invisible">
    </div>


     <script>
        // All elements needed

        const categoryList = document.getElementById('category-list');
        const categoryLoader = document.getElementById('category-loader-spinner');
        const productsGrid = document.getElementById('products-grid');
        const plantsLoader = document.getElementById('plants-loader-spinner');
        const cartItemsContainer = document.getElementById('cart-items-container');
        const cartItemCount = document.getElementById('cart-item-count');
        const cartTotalDisplay = document.getElementById('cart-total-display');
        const detailsModal = document.getElementById('product-details-modal');
        const modalCloseButton = document.getElementById('modal-close-button');
        const modalContentContainer = document.getElementById('modal-content-container');
        const alertMessage = document.getElementById('alert-message');

        let allPlants = [];
        let shoppingCart = [];
        let displayedPlants = [];

        // Fetches all plant categories
        async function fetchAndRenderCategories() {
            try {
                categoryLoader.classList.remove('hidden');
                const response = await fetch(`https://openapi.programming-hero.com/api/categories`);
                const data = await response.json();
                const categories = data.categories;

                categoryList.innerHTML = `<div class="bg-green-500 text-white font-medium px-4 py-2 rounded-lg cursor-pointer text-center lg:text-left hover:bg-green-200 hover:text-black transition-colors active-category" data-category-id="all">All Plants</div>`;

                categories.forEach(category => {
                    const categoryFilter = document.createElement('div');
                    categoryFilter.classList.add('bg-white', 'text-gray-700', 'font-medium', 'px-4', 'py-2', 'rounded-lg', 'cursor-pointer', 'text-center', 'lg:text-left','hover:bg-green-200', 'transition-colors');
                    categoryFilter.textContent = category.category_name;
                    categoryFilter.dataset.categoryId = category.id;
                    categoryList.appendChild(categoryFilter);
                });
            } catch (error) {
                console.error('Error fetching categories:', error);
            } finally {
                categoryLoader.classList.add('hidden');
            }
        }

        // Updates the active state of a category button

        function updateActiveCategoryButton(id) {
            document.querySelectorAll('#category-list > div').forEach(button => {
                button.classList.remove('active-category', 'bg-green-500', 'text-green-700');
                button.classList.add('bg-white', 'text-gray-700');
            });
            const activeButton = document.querySelector(`[data-category-id="${id}"]`);
            if (activeButton) {
                activeButton.classList.add('active-category', 'bg-green-500','text-white','hover:text-black' );
                activeButton.classList.remove('bg-white', 'text-gray-700');
            }
        }

        // Fetches and displays all plants

        async function fetchAndDisplayAllPlants() {
            try {
                productsGrid.innerHTML = '';
                plantsLoader.classList.remove('hidden');
                const response = await fetch(`https://openapi.programming-hero.com/api/plants`);
                const data = await response.json();
                allPlants = data.plants;
                displayedPlants = allPlants;
                displayPlants(allPlants);
            } catch (error) {
                console.error('Error fetching all plants:', error);
            } finally {
                plantsLoader.classList.add('hidden');
            }
        }

        // Fetches and displays plants for a specific category

        async function fetchAndDisplayPlantsByCategory(categoryId) {
            try {
                productsGrid.innerHTML = '';
                plantsLoader.classList.remove('hidden');
                const response = await fetch(`https://openapi.programming-hero.com/api/category/${categoryId}`);
                const data = await response.json();
                displayedPlants = data.plants;
                displayPlants(displayedPlants);
            } catch (error) {
                console.error('Error fetching plants by category:', error);
            } finally {
                plantsLoader.classList.add('hidden');
            }
        }

        // Renders plant cards

        function displayPlants(plants) {
            productsGrid.innerHTML = '';
            if (plants.length === 0) {
                productsGrid.innerHTML = '<p class="col-span-1 sm:col-span-2 lg:col-span-3 text-center text-gray-500">No plants found for this category.</p>';
            }
            plants.forEach(plant => {
                const productCard = document.createElement('div');
                productCard.classList.add('bg-white', 'rounded-xl', 'shadow-md', 'overflow-hidden', 'flex', 'flex-col', 'justify-between', 'transform', 'transition-transform', 'hover:scale-105', 'cursor-pointer');
                productCard.dataset.plantId = plant.id;
                productCard.innerHTML = `
                    <img loading="lazy" src="${plant.image}" alt="${plant.name}" class="w-full h-48 object-cover">
                    <div class="p-4 flex flex-col gap-2">
                        <p class="text-lg font-semibold text-green-800">${plant.name}</p>
                        <p class="text-sm text-gray-500 line-clamp-2">${plant.description}</p>
                        <div class="flex justify-between items-center mt-2">
                            <span class="bg-green-100 text-green-700 text-xs font-medium px-2 py-1 rounded-full">${plant.category}</span>
                            <p class="text-md font-bold text-green-800">৳${plant.price}</p>
                        </div>
                        <button value="${plant.id}" class="add-to-cart-button bg-green-700 text-white px-4 py-2 mt-4 rounded-lg font-semibold hover:bg-green-800 transition-colors">Add to Cart</button>
                    </div>
                `;
                productsGrid.appendChild(productCard);
            });
        }

        // Alert Cart

        function showMessageBox(message) {
            alertMessage.textContent = message;
            alertMessage.classList.remove('invisible', 'opacity-0');
            alertMessage.classList.add('visible', 'opacity-100');
            setTimeout(() => {
                alertMessage.classList.remove('visible', 'opacity-100');
                alertMessage.classList.add('invisible', 'opacity-0');
            }, 3000);
        }

        // Adds a plant to the shopping cart

        function addPlantToCart(plant) {
            const existingItem = shoppingCart.find(item => item.id === plant.id);
            if (existingItem) {
                existingItem.quantity++;
            } else {
                shoppingCart.push({ ...plant, quantity: 1 });
            }
            updateShoppingCartDisplay();
            showMessageBox(`${plant.name} added to cart!`);
        }

        // Updates the shopping cart display


        function updateShoppingCartDisplay() {
            cartItemsContainer.innerHTML = '';
            let total = 0;
            shoppingCart.forEach(item => {
                const cartItem = document.createElement('div');
                cartItem.classList.add('flex', 'justify-between', 'items-center', 'p-3', 'bg-gray-100', 'rounded-lg', 'shadow-sm');
                cartItem.innerHTML = `
                    <div class="flex-grow">
                        <p class="font-semibold text-gray-800">${item.name}</p>
                        <p class="text-sm text-gray-600">৳${item.price}x${item.quantity}</p>
                    </div>
                    <button class="remove-from-cart-button text-red-500 font-bold ml-4" value="${item.id}">&times;</button>
                `;
                cartItemsContainer.appendChild(cartItem);
                total += item.price * item.quantity;
            });
            cartItemCount.textContent = shoppingCart.length;
            cartTotalDisplay.textContent = `৳${total}`;
        }

        async function showPlantDetailsInModal(plantId) {
            modalContentContainer.innerHTML = `
                <div class="flex justify-center items-center h-48">
                    <div class="loading-spinner w-24 h-24">
                        <div class="spinner-bar"></div><div class="spinner-bar"></div><div class="spinner-bar"></div><div class="spinner-bar"></div><div class="spinner-bar"></div><div class="spinner-bar"></div><div class="spinner-bar"></div><div class="spinner-bar"></div><div class="spinner-bar"></div><div class="spinner-bar"></div><div class="spinner-bar"></div><div class="spinner-bar"></div>
                    </div>
                </div>
            `;
            detailsModal.classList.remove('hidden');

            try {
                const response = await fetch(`https://openapi.programming-hero.com/api/plant/${plantId}`);
                if (!response.ok) {
                    modalContentContainer.innerHTML = `<p class="text-center text-red-500 font-bold">Could not get plant details. Please try another plant.</p>`;
                    return;
                }

                const data = await response.json();
                const plant = data.plants;

                if (!plant) {
                    modalContentContainer.innerHTML = `<p class="text-center text-red-500 font-bold">Plant details not found. Please try another plant.</p>`;
                    return;
                }

                modalContentContainer.innerHTML = `
                    <img src="${plant.image}" alt="${plant.name}" class="w-full h-auto rounded-lg mb-4 mt-6 max-h-[300px] object-cover">
                    <h2 class="text-2xl font-bold text-green-800 mb-2">${plant.name}</h2>
                    <span class="bg-green-100 text-green-700 text-sm font-medium px-3 py-1 rounded-full inline-block mb-4">${plant.category}</span>
                    <p class="text-gray-700 text-base mb-4">${plant.description}</p>
                    <p class="text-2xl font-bold text-green-800">৳${plant.price}</p>
                    <button class="add-to-cart-modal-button bg-green-700 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-800 transition-colors w-full mt-4" value="${plant.id}">Add to Cart</button>
                `;

                const modalAddToCartButton = document.querySelector('#modal-content-container .add-to-cart-modal-button');
                modalAddToCartButton.addEventListener('click', () => {
                    addPlantToCart(plant);
                    closeModal();
                });
            } catch (error) {
                console.error('An unexpected error occurred while fetching plant details:', error);
                modalContentContainer.innerHTML = `<p class="text-center text-red-500 font-bold">An unexpected error occurred. Please check your internet connection.</p>`;
            }
        }

        // Closes the modal

        function closeModal() {
            detailsModal.classList.add('hidden');
            modalContentContainer.innerHTML = '';
        }

        // Event listener for the entire document

        document.addEventListener('click', (event) => {
            const target = event.target;

            if (target.dataset.categoryId) {
                const id = target.dataset.categoryId;
                updateActiveCategoryButton(id);
                if (id === 'all') {
                    displayPlants(allPlants);
                } else {
                    fetchAndDisplayPlantsByCategory(id);
                }
            }
        });

        // Event listener for the product grid

        productsGrid.addEventListener('click', (event) => {
            const target = event.target;

            // Open modal

            if (target.closest('[data-plant-id]') && !target.classList.contains('add-to-cart-button')) {
                const plantId = target.closest('[data-plant-id]').dataset.plantId;
                showPlantDetailsInModal(plantId);
            }

            // Add to cart button click
            if (target.classList.contains('add-to-cart-button')) {
                const plantId = target.value;
                const plantToAdd = allPlants.find(plant => plant.id === parseInt(plantId));
                if (plantToAdd) {
                    addPlantToCart(plantToAdd);
                }
            }
        });

        // Event listener for the cart items container
        cartItemsContainer.addEventListener('click', (event) => {
            const target = event.target;

            if (target.classList.contains('remove-from-cart-button')) {
                const plantId = target.value;
                shoppingCart = shoppingCart.filter(item => item.id !== parseInt(plantId));
                updateShoppingCartDisplay();
            }
        });

        // Modal close

        modalCloseButton.addEventListener('click', closeModal);
        detailsModal.addEventListener('click', (event) => {
            if (event.target === detailsModal) {
                closeModal();
            }
        });

    //    Fetch

        fetchAndRenderCategories();
        fetchAndDisplayAllPlants();
    </script>

    </body>

</html>